---
import BaseLayout from "../layouts/BaseLayout.astro";
import ArticleCard from "../components/ArticleCard.astro";
import { getCollection } from "astro:content";

const news = (await getCollection('news')).sort((a,b) => +new Date(b.data.date) - +new Date(a.data.date));
const anniversari = (await getCollection('anniversari')).sort((a,b) => +new Date(b.data.date) - +new Date(a.data.date));
const compleanni = (await getCollection('compleanni')).sort((a,b) => +new Date(b.data.date) - +new Date(a.data.date));

const latestNews = news.slice(0,3);
const latestAnn = anniversari.slice(0,1);
const latestComp = compleanni.slice(0,1);
---
<BaseLayout title="SDAC Magazine" current="home">
  <div class="grid cols3">
    <section class="card">
      <div class="pad">
        <h2>News</h2>
        <p class="meta">Ultimi aggiornamenti e novità.</p>
        <ul class="list">
          {latestNews.map((e) => <li><ArticleCard entry={e} collection="news" /></li>)}
        </ul>
        <p class="meta" style="margin-top:10px"><a href="/news">Vedi tutte le News →</a></p>
      </div>
    </section>

    <section class="card">
      <div class="pad">
        <h2>Anniversari</h2>
        <p class="meta">Film che compiono anni (e spesso non li dimostrano).</p>
        <ul class="list">
          {latestAnn.map((e) => <li><ArticleCard entry={e} collection="anniversari" /></li>)}
        </ul>
        <p class="meta" style="margin-top:10px"><a href="/anniversari">Vedi tutti gli Anniversari →</a></p>
      </div>
    </section>

    <section class="card">
      <div class="pad">
        <h2>Compleanni</h2>
        <p class="meta">Registi, attori e attrici: oggi si festeggia.</p>
        <ul class="list">
          {latestComp.map((e) => <li><ArticleCard entry={e} collection="compleanni" /></li>)}
        </ul>
        <p class="meta" style="margin-top:10px"><a href="/compleanni">Vedi tutti i Compleanni →</a></p>
      </div>
    </section>
  </div>
</BaseLayout>
